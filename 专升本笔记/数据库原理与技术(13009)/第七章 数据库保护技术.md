事务
	事务 (Transaction) 是指用户定义的对数据库操作的多条语句序列，可以为插入、
	修改、删除或检索，这些操作要么全做，要么全不做，是一个不可分割的工作单元。
	只读事务
	读写事务
	定义事务的语法格式:
		Begin Transact ion：
		Commit Transact ion： <事务提交提示>
		Rollback Transact ion： <事务回滚提示>
	事务的ACID性质
		保证数据库的完整性,必须具备四个性质:
			原子性
				操作要么全部执行，要么全部都不执行
			一致性
				一个事务执行的结果应保持数据库的一致性，即数据的完整性不会因为事务的执行而遭到破坏。
			隔离性
				当多个事务并发执行时，数据库系统要能保证任何一个事务的执行都不干扰别的事务的执行
			持久性
				一个事务成功完成后，它对数据库的所有更新操作应永久反映在数据库中
	事务的状态变迁图:
		活动状态
			前事务一旦隐式或显式遇到Begin Transaction语句，便立即进入活动状态。事务将进行对数 据库的读写操作。其中的“写”并不是写硬盘，而是写在系统缓冲区中。
		部分提交状态
			在事务没有遇到Commit Transaction 以前，事务对数据库的操作都属于部分提交状态。
		失败状态
			处于活动状态的事务，在没有到最后一条语句就中止执行，此时称事务进入“失败”状态。
		异常中止状态
			处于失败状态的事务，很可能对磁盘中的数据进行了部分修改。为了保证事务的原子性，应该撤销该事务对数据库做的任何修改。对事务的撤销操作称为事务的回退
			处于失败状态的事务遇到Rollback Transaction语句时，事务回滚，数据库被恢复到事务开始执行前的状态，事务处于异常中止状态
		提交状态
			处于部分提交状态的事务，如果没有发生任何意外，一旦遇到CommitTransaction语句，会把对数据库的所有修改全部写到磁盘上，事务进入“提交”状态
	事务管理器
		日志管理器
			事务管理器将关于事务动作的消息传递给日志管理器，将数据更新以及何时将更新 的内容写回到磁盘的信息传给缓冲管理器，将有关可以查询的信息传给查询处理器。
			日志管理器主要维护日志信息，并通知缓冲管理器何时把日志信息写到磁盘上。
			恢复管理器主要负责系统崩溃时，利用日志信息将数据恢复到最近状态。
		数据库并发操作:
			并发是指在同一时间段里，一个CPU执行多个进程。一个进程可以分出不同的时间片、执行不同的任 务，这就是线程 (Thread)
			DBMS属于多用户、共享系统，许多事务可能在同一时间对同一数据进行操作，这就是“并发操作”
			DBMS的==并发控制子系统==就是负责协调并发事务执行的，它可保证数据库的完整性，同时避免用户得到不正确的数据
			并发产生的三个问题:
				丢失更新
					两个事务同时读取数据并进行更新，若未加以控制，会造成某一事务的更新丢失
				不可重复读
					两个事务同时操作同一个数据项，有可能出现某一事务在读取该数据项时，该数据项已被另一个事务修改了，造成“不可读”到原数据项
				读“脏”数据
					一个事务修改某一数据项，另一事务读取了该数据项，但由于某些原因前一事务的修改要撤销，此时后一事务读取的数据就会出现与数据库中的数据不一致的情况，此时称后一事务读取到数据为“脏”数据
			并发调度的可串行化
				事务的执行次序称为“调度” 。如果多个事务依次执行，则称为事务的“串行调度”，如果利用分时的方法同时处理多个事务，则称为事务的“并发调度”。
			封锁技术:
				锁 (Lock) 是一个与数据项相关的变量，对可能应用于该数据项上的操作而言，锁描述了该数据项的状态。
				状态:
					排他锁 (Exclusive Lock，简称X锁) ：又称写锁，某一事务对某个数据项加上X锁，只允许该事务读取和更新数据，直到该事务释放此数据项上的锁，其他事务才可以再加新锁
					共享锁 (Share Lock，简称S锁) ：又称读锁，某一事务对某个数据项加上S锁，只允许该事务读取数据，但不能更新数据，其他事务可以加S锁，但不能加X锁
				级别:
					一级封锁协议：
						只加X锁,防止丢失更新
					二级封锁协议：
						加X和S锁,读完后,立即释放S锁.防止丢失更新,也能防止读“脏”数据问题
					三级封锁协议：
						加X和S锁,事务结束,才释放S锁
				封锁带来的问题及解决办法:
					活锁：多个事务请求同一数据封锁时，总是某一个用户在等待，得不到封锁的情况，称为活锁。
						解决活锁的办法是“先来先服务”的策略，即队列方式解决。
					死锁：系统中有两个或两个以上的事务都处于等待状态，并且每个事务都在等待其中另一个事务解除封锁，它才能够继续进行下去，结果造成任何一个事务都无法继续执行
						解决死锁的 方法是选择一个处理死锁代价比较小的事务，将其撤销，释放此事务持有的 所有锁
				锁的粒度:
					封锁对象的大小称为封锁粒度。封锁对象可以是逻辑单元，也可以是物理单元。
					封锁的粒度与系统的并发度和并发控制的开销密切相关。封锁的粒度越大，并发度也就越小，但同时系统的开销也就越小
	数据库的恢复技术
		数据库系统能把数据库从被破坏、不正确的状态恢复到最近一个正确的状态，DBMS的这种能力被称为数据库的可恢复性
			==数据恢复的基本原理非常简单，就是冗余==。最常用的技术就是数据备份 (Backup) 和记录日 志文件 (Log) 。
		故障的种类:
			事务故障：事务在执行的过程中发生的故障，称为事务故障
			系统故障：引起系统停止运转，随之要求系统必须重新启动的事件，称为系统故障。
			介质故障：硬盘上的数据库遭到破坏，使数据库系统无法正常运行，这类故障称为介质故障
			计算机病毒：数据库遭到计算机病毒的破坏
		数据转储:
			备份文件只能恢复到转储时的状态,转储后的数据无法直接恢复,这时就要==依赖日志文件进行恢复==
				解决办法:
					静态转储：静态转储也称数据库备份，是指数据库在没有任何事务操作的状态下，数据库文件的复制。该方法比较简单，但能获得一致性的副本。
					动态转储：允许其他事务对数据库进行操作的同时进行数据库的复制
	数据库的完整性控制
		数据的完整性：数据的正确性、有效性和相容性，目的是为了防止错误的数据进入数据库。
			正确性：数据的合法、语义的正确。例如数值型数据中只能含有数字，不能含有字母
			有效性：数据取值的有效范围。例如成绩只能取0-100
			相容性：同一个事实的两个数据应该相同，不一致就是不相容性。
		完整性子系统
			监督事务的执行，检测是否违反完整性规则
			如有违反现象，则采取适当的操作等
		完整性约束类别:
			列级约束
				列级约束也称属性取值约束，这是最常用、最容易实现的一类完整性约束
			元组级约束
				一个元组是由若干个有序的属性值组成的，在同一个元组中，其属性之间的取值也可以定义 某些制约条件。
			表级约束
				在一个表中的各个元组，或多个表之间的属性取值的约束
	数据库安全控制
		数据库的安全性是保护数据以防止非法用户对数据库的操作，而完整性是保护数据库以防止合法用户对数据的错误输入。
		权限问题:
			访问数据的权限有四个：
				读 (Select) ：允许用户查询数据。
				插入 (Insert) ：允许用户插入数据。
				修改 (Update) ：允许用户修改数据。
				删除 (Delete) ：允许用户删除数据。
			修改数据库结构的权限也有四个：
				索引 (Index) 权限：允许用户创建、删除索引。
				资源 (Resource) 权限：允许用户创建新的表。
				修改 (Alteration) 权限：允许用户修改表的结构。
				撒销 (Drop) 权限：允许用户撤销表。
			四大安全机制:
				视图
					用户只能查看视图定义中的数据，而 不能查看外、基本表中的数据，如此保证了数据的安全性。
				权限
					DBMS的授权子系统负责用户对数据库使用权限的授予与收回。
				角色
					指具有某一类权限的一个抽象的用户或一个称呼，如数据库管理员、数据库备份员、销售主管
				审计
					就是把用户对数据库的所有操作自动记录下来存入审计日志 (AuditLog) 中，这样，一旦教据库发生非法存取，DBA就可以利用审计来跟踪信息，查找非法存取数据的人，事件和内容等。
